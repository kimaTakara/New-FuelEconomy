# New-FuelEconomy

※ 以下はgemini code assistを使い、自動作成したものを編集しています。今後適宜変更を加える予定です。

## 概要

Google Apps Script (GAS) を利用して、車両の燃費を記録・計算・可視化するためのプロジェクトです。給油記録を登録すると燃費が計算され、日報・月報を作成することができます。

## 主な機能

- **自動計算**: 自動車の燃費表示を入力することで、走行ごとの燃費（km/L）を自動で計算します。
- **データ集計**: Google スプレッドシートにすべての給油記録を蓄積し、管理します。
- **データ入力の簡素化（オプション）**: Google フォームやAppSheetを利用することで、スマートフォンなどから簡単かつ迅速に給油データを入力することも可能瀬です。私はAppSheetを作成して自動的に反映しています。ご要望があればAppSheetを公開することも検討しています。
- **可視化（オプション）**: スプレッドシートのグラフ機能を使えば、燃費の推移や月々のガソリン代などを可視化できます（これは今のところ未実装です）。

## 必要なもの

- Google アカウント
- (開発者向け) [clasp](https://github.com/google/clasp) - ローカル環境でコードを編集する場合

## セットアップ方法

1.  **本リポジトリをクローンまたはダウンロードします。**

    ```bash
    git clone https://github.com/your-username/New-FuelEconomy.git
    cd New-FuelEconomy
    ```

2.  **Google スプレッドシートを新規作成します。**
    このシートが燃費データのデータベースになります。

3.  **Apps Script プロジェクトの作成とコードのデプロイ**

    - 作成したスプレッドシートから、「拡張機能」>「Apps Script」を選択してスクリプトエディタを開きます。
    - ローカルのコードをプロジェクトに反映させます。`clasp` を利用するのが最も簡単です。
      - `clasp login` で Google アカウントにログインします。
      - `clasp push` でローカルのコードを Web 上のプロジェクトにアップロードします。
      - （もし`clasp`を使わない場合）スクリプトエディタにコードをコピー＆ペーストします。

4.  **Google フォームを作成します。**

    - スプレッドシートの「ツール」>「フォームを作成」から新しいフォームを作成します。
    - フォームには、少なくとも以下の質問項目を設定してください。
      - `日付` (Date)
      - `走行距離 (ODOメーター)` (Number)
      - `給油量 (L)` (Number)
      - `金額 (円)` (Number)
      - `満タンフラグ` (Checkbox, 例: "今回は満タンにしましたか？")

5.  **トリガーを設定します。**
    - スクリプトエディタの左側メニューから「トリガー」⏰ を選択します。
    - 「トリガーを追加」ボタンをクリックし、以下のように設定します。
      - **実行する関数を選択**: `onFormSubmit` （※コード内の関数名に合わせてください）
      - **実行するデプロイを選択**: `Head`
      - **イベントのソースを選択**: `スプレッドシートから`
      - **イベントの種類を選択**: `フォーム送信時`
    - 「保存」をクリックします。初回は Google アカウントによるスクリプト実行の承認を求められます。

## 使い方

1.  セットアップで作成した Google フォームを開き、給油情報を入力して送信します。
2.  スプレッドシートにデータが自動で追加され、燃費が計算されていれば成功です。

## `.gitignore` について

このプロジェクトの `.gitignore` ファイルには、以下のファイルが指定されています。これらはバージョン管理に含めるべきではないファイルです。

- `.clasp.json`: `clasp` の設定ファイルで、個人の認証情報やスクリプト ID が含まれるため、リポジトリに含めません。
- `appsscript.json`: プロジェクトのマニフェストファイルです。環境によって自動生成・更新されることがあるため、意図しない差分を防ぐために除外しています。

## ライセンス

このプロジェクトは MIT License のもとで公開されています。

## 貢献

プルリクエストや Issue の報告を歓迎します。改善のための提案があれば、ぜひお願いします。
